---
title: "Untitled"
author: "Arun Kumar"
date: "2025-05-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(TCGAbiolinks)
library(tidyverse)
library(maftools)
library(pheatmap)
library(SummarizedExperiment)
library(edgeR)
library(limma)
library(GEOquery)
library(tidyverse)
library(DESeq2)
library(patchwork)
library(CorLevelPlot)

```

```{r}
lich_data <- readRDS("lihc_data.RDS")
lich_data
```
```{r}
limma_res$voomObj$E
```

```{r}

fpkm_mat <- as.data.frame(assay(lich_data, "fpkm_unstrand"))
fpkm_mat
########
gene_names <- as.data.frame(lich_data@rowRanges) 
gene_namess <- gene_names %>% 
  dplyr::select(gene_name)
#########
coldata <- as.data.frame(lich_data@colData)
coldata 
```


```{r}
gsg <- goodSamplesGenes(t(fpkm_mat))
```

```{r}
summary(gsg)
```

```{r}
fpkm_mat <- fpkm_mat[gsg$goodGenes == TRUE,]
```

```{r}
htree <- hclust(dist(t(fpkm_mat)),method = "average")
plot(htree)
# Plot the sample dendrogram
png("visuals/htree_sample_clustering.png", width = 2000, height = 1200, res = 150)

plot(htree, main = "Sample Clustering to Detect Outliers",
     sub = "", xlab = "", cex.lab = 2, cex.axis = 2, cex.main = 2, cex = 0.5)
dev.off()
```


```{r}
all(colnames(fpkm_mat) == rownames(coldata))
all(colnames(fpkm_mat) %in% rownames(coldata))
```

```{r}
# create dds
dds <- DESeqDataSetFromMatrix(countData = fpkm_mat,
                              colData = coldata,
                              design = ~ 1) # not spcifying model
```

```{r}
v$E
```

```{r}

```




























































































































































































































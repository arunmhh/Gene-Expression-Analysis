---
title: "Untitled"
author: "Arun Kumar"
date: "2025-05-20"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
Sys.setenv(XML_CONFIG = "/usr/bin/xml2-config")
install.packages("XML", type = "source")

```

```{r, echo=FALSE}
library(TCGAbiolinks)
library(tidyverse)
library(maftools)
library(pheatmap)
library(SummarizedExperiment)
```

```{r}
# get a list of projects
gdcprojects <- getGDCprojects()
getProjectSummary('TCGA-LIHC')
```

```{r}
# building a query
query_TCGA <- GDCquery(project = 'TCGA-LIHC',
         data.category = 'Transcriptome Profiling')
output_query_TCGA <- getResults(query_TCGA)
```

```{r}
# build a query to retrieve gene expression data ------------
query_TCGA_RNA_PTumor <- GDCquery(project = 'TCGA-LIHC',
                       data.category = 'Transcriptome Profiling',
                       experimental.strategy = 'RNA-Seq',
                       workflow.type = 'STAR - Counts',
                       access = 'open',
                       sample.type = "Primary Tumor")
```

```{r}
query_TCGA_RNA_Control <- GDCquery(project = 'TCGA-LIHC',
                       data.category = 'Transcriptome Profiling',
                       experimental.strategy = 'RNA-Seq',
                       workflow.type = 'STAR - Counts',
                       access = 'open',
                       sample.type = "Solid Tissue Normal")
```

```{r}
getResults(query_TCGA_RNA_PTumor)
getResults(query_TCGA_RNA_Control)
```

```{r}
GDCdownload(
  query = query_TCGA_RNA_PTumor,
            directory = "/Volumes/NGS/tcga_geneexpression/Gene-Expression-Analysis/GDCdata")
#GDCdownload(
 # query = query_TCGA_RNA_Control,
  #directory = "/Volumes/NGS/tcga_geneexpression/Gene-Expression-Analysis/GDCdata")
```

```{r}
query_TCGA_RNA_Controldata <- GDCprepare(query_TCGA_RNA_Control,
                                         summarizedExperiment = TRUE)

print(query_TCGA_RNA_Controldata)

query_TCGA_RNA_PTumordata <- GDCprepare(query_TCGA_RNA_PTumor,
                                         summarizedExperiment = TRUE)

print(query_TCGA_RNA_PTumordata)
```

######################################################################### 

count to DEGs
